### Frontend Dashboard
---
*   The frontend dashboard (built with React/Vite) uses Zustand for state management.
    *   State is split into two main stores:
        *   [`analyticsHttpStore.ts`](dashboard/app/stores/analyticsHttpStore.ts:0): Manages site/preference data fetching and the selected site. It is the **sole source of truth** for persisted UI state related to selected card tabs (e.g., `sourcesCardTab`, `pagesCardTab`) and the selected date-range *key* (`selectedRangeKey`). It provides `getSelectedDateRangeObject()` to compute the `DateRange` object from `selectedRangeKey`. All these UI states (tabs, date range key, modals) are persisted to `localStorage` via its `partialize` and `onRehydrateStorage` logic.
        *   [`analyticsSqlStore.ts`](dashboard/app/stores/analyticsSqlStore.ts:0): Manages the DuckDB WASM instance and orchestrates fetching API data. It **subscribes** to tab state and `selectedRangeKey` changes in [`analyticsHttpStore.ts`](dashboard/app/stores/analyticsHttpStore.ts:0). When a tab state changes, [`analyticsSqlStore.ts`](dashboard/app/stores/analyticsSqlStore.ts:0) updates its internal reflection and triggers `runSpecificAggregation` for the relevant card. For date ranges, it fetches `selectedRangeKey` from [`analyticsHttpStore.ts`](dashboard/app/stores/analyticsHttpStore.ts:0) (using it or `getSelectedDateRangeObject()`) to compute the `DateRange` object at the time of data fetching/aggregation. It **no longer persists** its own tab states or the selected date range. Data loading and aggregations are still triggered via [`analyticsSql.ts`](dashboard/app/stores/analyticsSql.ts:0).
        *   `analyticsSql.ts`: Contains functions for direct DuckDB interaction, including creating tables/views, loading data, and executing aggregation queries.
*   **Component Data Fetching & Rendering:**
        *   [`DashboardContent.tsx`](dashboard/app/components/dashboard/DashboardContent.tsx:0) no longer passes `aggregatedData` or `loading` props to individual [`CardContainer.tsx`](dashboard/app/components/dashboard/CardContainer.tsx:0) instances.
        *   Each [`CardContainer.tsx`](dashboard/app/components/dashboard/CardContainer.tsx:0) now selects its specific data slice directly from [`analyticsSqlStore.ts`](dashboard/app/stores/analyticsSqlStore.ts:0) using its `meta.dataSelector` and `useShallow`.
        *   The loading state for each card is derived from `sqlStatus` within [`analyticsSqlStore.ts`](dashboard/app/stores/analyticsSqlStore.ts:0).
        *   This approach ensures that only the card whose data or tab selection has actually changed will re-render, significantly improving performance.